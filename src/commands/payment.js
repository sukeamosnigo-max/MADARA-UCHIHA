const a25_0x5a029d=a25_0x1bf5;(function(_0x45c893,_0x5d344e){const _0x571812=a25_0x1bf5,_0x29bc5c=_0x45c893();while(!![]){try{const _0x12dbef=-parseInt(_0x571812(0x8c))/0x1*(-parseInt(_0x571812(0xb0))/0x2)+parseInt(_0x571812(0xd7))/0x3+parseInt(_0x571812(0xb6))/0x4*(-parseInt(_0x571812(0xe0))/0x5)+parseInt(_0x571812(0x116))/0x6+-parseInt(_0x571812(0xd5))/0x7*(parseInt(_0x571812(0xda))/0x8)+-parseInt(_0x571812(0x106))/0x9*(-parseInt(_0x571812(0x115))/0xa)+parseInt(_0x571812(0x124))/0xb*(-parseInt(_0x571812(0xf7))/0xc);if(_0x12dbef===_0x5d344e)break;else _0x29bc5c['push'](_0x29bc5c['shift']());}catch(_0x3bb2b4){_0x29bc5c['push'](_0x29bc5c['shift']());}}}(a25_0x2080,0xed619));const {Lipana}=require(a25_0x5a029d(0xac));let lipana=null,botSocket=null;const ADMIN_NUMBERS=[a25_0x5a029d(0xb3),a25_0x5a029d(0xd3)];function setBotSocket(_0x2778fd){botSocket=_0x2778fd;}function initLipana(){const _0x4b9b55=a25_0x5a029d,_0x3191f5={'ITVER':'GIVdn','YFkNi':'EjCxn','bpHhq':'(((.+)+)+)+$','PXYgn':function(_0x544403,_0x47833e,_0x2bd6c7){return _0x544403(_0x47833e,_0x2bd6c7);},'GPCpP':function(_0x52dbc0){return _0x52dbc0();},'ESqfz':'LIPANA_SECRET_KEY\x20not\x20set\x20-\x20payment\x20features\x20will\x20not\x20work','Fjaqp':_0x4b9b55(0xd8),'YcNaJ':'production'},_0x447a1e=(function(){const _0x13909d=_0x4b9b55,_0x23b9c6={'wAulG':_0x3191f5[_0x13909d(0xb8)],'VVdNK':_0x3191f5[_0x13909d(0x83)],'LBymc':function(_0x1d5e20,_0x1f8699){return _0x1d5e20===_0x1f8699;},'wijHn':_0x13909d(0xeb),'pqnLk':_0x13909d(0xfd)};let _0x25f220=!![];return function(_0x18ef3c,_0x390967){const _0x5c3a5=_0x13909d,_0x20d520={'HLLoI':function(_0x489e3b){return _0x489e3b();}};if(_0x23b9c6[_0x5c3a5(0x107)]===_0x23b9c6[_0x5c3a5(0xc7)])_0x4f5e6e=_0x20d520['HLLoI'](_0x1b7e02);else{const _0x3de45a=_0x25f220?function(){const _0x284a3a=_0x5c3a5;if(_0x23b9c6[_0x284a3a(0xef)]!==_0x23b9c6[_0x284a3a(0xf3)]){if(_0x390967){if(_0x23b9c6[_0x284a3a(0xc2)]('qyNfi','qyNfi')){const _0x4fbee0=_0x390967[_0x284a3a(0x11e)](_0x18ef3c,arguments);return _0x390967=null,_0x4fbee0;}else{if(_0x575dd9){const _0x14dab3=_0x150798['apply'](_0x55a850,arguments);return _0xe13344=null,_0x14dab3;}}}}else{const _0xce79c0=_0x43145f[_0x284a3a(0x11e)](_0x436417,arguments);return _0x3d6dcd=null,_0xce79c0;}}:function(){};return _0x25f220=![],_0x3de45a;}};}()),_0xb4cc40=_0x3191f5[_0x4b9b55(0xd1)](_0x447a1e,this,function(){const _0x27e938=_0x4b9b55;return _0xb4cc40[_0x27e938(0xe8)]()[_0x27e938(0xf6)](_0x3191f5['bpHhq'])[_0x27e938(0xe8)]()[_0x27e938(0x80)](_0xb4cc40)[_0x27e938(0xf6)](_0x3191f5[_0x27e938(0x7b)]);});_0x3191f5[_0x4b9b55(0xf4)](_0xb4cc40);if(!process['env'][_0x4b9b55(0x89)])return console[_0x4b9b55(0x114)](_0x3191f5[_0x4b9b55(0xbe)]),null;const _0x32e389=process[_0x4b9b55(0xa5)][_0x4b9b55(0xf1)]===_0x3191f5[_0x4b9b55(0x118)]?_0x3191f5['Fjaqp']:_0x3191f5[_0x4b9b55(0x8e)];return console[_0x4b9b55(0x9d)]('Initializing\x20Lipana\x20in\x20'+_0x32e389+'\x20mode'),new Lipana({'apiKey':process[_0x4b9b55(0xa5)][_0x4b9b55(0x89)],'environment':_0x32e389});}function a25_0x2080(){const _0x10d276=['âœ…\x20Receipt\x20sent\x20to\x20customer:\x20','7563567NijtIU','delete','zVjVD','Africa/Nairobi','cfkkv','(((.+)+)+)+$','TRUE\x20âœ“','qty','eoGeQ','XCZyk','TEeSt','toLocaleString','bpHhq','Error\x20sending\x20receipt\x20to\x20customer:','success','kgvkO','UueUb','constructor','completed','âš¡\x20*ACTION:\x20Payment\x20verified\x20-\x20proceed\x20with\x20service\x20delivery*','YFkNi','sendMessage','VZabo','failed','scuyn','replace','LIPANA_SECRET_KEY','transactionId','Zzzku','11pjXiUd','âŒ\x20FAILED','YcNaJ','mpesaRef','TDYVf','pzjYj','zEuFa','qivGb','TqBgw','DTsjt','timestamp','XjCUC','initiateStkPush','workflowId','phone','\x0aâ”œâ”€\x20Reference:\x20','â”œâ”€\x20Status:\x20âœ…\x20CONFIRMED\x0a\x0aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\x0a\x0aâš¡\x20*What\x27s\x20Next?*\x0aYour\x20order\x20is\x20being\x20processed\x20and\x20will\x20be\x20delivered\x20within\x20a\x20few\x20minutes.\x0a\x0aðŸ“ž\x20*Need\x20Help?*\x0aContact\x20support:\x20254745282166\x20or\x20254759424232\x0a\x0aThank\x20you\x20for\x20your\x20business!\x20ðŸ™\x0a\x0aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\x0aðŸ¤–\x20MADARA\x20UCHIHA\x20Bot','log','OEBrP','WgzSX','pBxjH','tpqQh','GTbUL','ECExn','FpaxB','env','COMPLETED','HtKtq','CxBoq','\x0a\x0aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\x0aðŸ¤–\x20MADARA\x20UCHIHA\x20Payment\x20System','Payment\x20system\x20not\x20configured.\x20Contact\x20admin\x20to\x20set\x20up\x20LIPANA_SECRET_KEY','WPnqg','@lipana/sdk','PAYMENT_CALLBACK_URL\x20not\x20set\x20-\x20using\x20default\x20Lipana\x20callback\x20handling','âœ…\x20SUCCESS','Error\x20sending\x20payment\x20verification\x20to\x20admin:','122828TkmiAB','ZdHDI','â”œâ”€\x20M-PESA\x20Ref:\x20','254745282166@s.whatsapp.net','toISOString','FALSE\x20âœ—','63564pJvxZh','\x0a\x0aðŸ’³\x20*Payment\x20Information:*\x0aâ”œâ”€\x20Phone:\x20','ITVER','\x0aâ”œâ”€\x20Time:\x20','PAYMENT_CALLBACK_URL','lxodn','rxdeW','query','ESqfz','amount','checkoutRequestID','completedAt','LBymc','en-KE','startsWith','now','\x0aâ”œâ”€\x20Amount:\x20','pqnLk','paymentDetails','SjuNs','wqQeL','â”œâ”€\x20Transaction\x20ID:\x20','status','aQEMy','set','OmvSe','\x0aâ”œâ”€\x20Service:\x20','PXYgn','kfBaU','254759424232@s.whatsapp.net','ISTtK','1026781edWkWg','254','715605qiPRlf','sandbox','platform','72mxDFUh','Payment\x20initiation\x20failed','RjxEF','xIGYL','YDDZG','AynLc','215rWniOU','pmSma','QwJKw','Failed\x20to\x20send\x20receipt\x20via\x20phone\x20number\x20JID','\x0a\x0aðŸ’³\x20*Payment\x20Summary:*\x0aâ”œâ”€\x20Amount\x20Paid:\x20','YynRO','N/A','YVkAO','toString','\x0aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\x0a\x0a','\x0aâ”œâ”€\x20Link:\x20','OBNmk','xdufr','transactions','hdZGn','wAulG','exports','LIPANA_ENV','joqKD','VVdNK','GPCpP','Tzryz','search','24aveyMW','QmTEM','2|4|3|1|0','EqDbb','SFrNE','\x20*PAYMENT\x20VERIFICATION*\x0aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\x0a\x0aðŸ“‹\x20*Transaction\x20Details:*\x0aâ”œâ”€\x20Order\x20ID:\x20','CJUZO','BKruG','TcQjy','âš ï¸\x20*ACTION:\x20Payment\x20failed\x20-\x20contact\x20customer\x20for\x20resolution*','service','message','nJBfH','WHewQ','Ezaqd','9jDCWIW','wijHn','error','\x0aâ”œâ”€\x20Date\x20&\x20Time:\x20','Bot\x20socket\x20not\x20available\x20for\x20payment\x20verification\x20notification','KUjiN','aQYqY','pmkPQ','split','sDWWb','get','orderId','QUbBu','link','warn','18893360YdZiLC','9285252vmXUWH','Payment\x20system\x20not\x20configured','Fjaqp','dEfzc','/=\x20KES\x0aâ”œâ”€\x20Phone\x20Number:\x20','ymOZj','Bot\x20socket\x20not\x20available\x20for\x20customer\x20receipt','NCROB','apply','@s.whatsapp.net','âœ…\x20Payment\x20verification\x20sent\x20to\x20admin:\x20','VejAL','knGvz'];a25_0x2080=function(){return _0x10d276;};return a25_0x2080();}lipana=initLipana();const pendingPayments=new Map();async function initiateSTKPush(_0x4348e9,_0x153cc6,_0x568c5b,_0x14a41a=null,_0x2c57a5=null){const _0x3fb303=a25_0x5a029d,_0xe1cfba={'ECExn':function(_0x4d1164,_0x536133){return _0x4d1164===_0x536133;},'WPnqg':'ZjMWK','UueUb':_0x3fb303(0x119),'pzjYj':function(_0x2a42f0){return _0x2a42f0();},'vvxCX':'Payment\x20system\x20not\x20configured.\x20Contact\x20admin\x20to\x20set\x20up\x20LIPANA_SECRET_KEY','ymOZj':function(_0x222152,_0x1a1f77){return _0x222152+_0x1a1f77;},'FpaxB':_0x3fb303(0xd6),'XCZyk':function(_0x575484,_0x3a13bb){return _0x575484!==_0x3a13bb;},'ZdHDI':_0x3fb303(0x104),'QwJKw':function(_0x33d8a6,_0x2154d0){return _0x33d8a6+_0x2154d0;},'YVkAO':function(_0x3c4be9,_0x46b94e){return _0x3c4be9!==_0x46b94e;},'DTsjt':'vbzzE','TDYVf':_0x3fb303(0xdd),'HtKtq':function(_0x481dd2,_0x52ee86){return _0x481dd2(_0x52ee86);},'lAeOD':'pending','joqKD':function(_0x187073,_0x5f4b48){return _0x187073&&_0x5f4b48;},'AynLc':'STK\x20Push\x20sent\x20successfully','TcQjy':'Lipana\x20STK\x20Push\x20Error:','cfkkv':_0x3fb303(0xdb)};if(!lipana){if(_0xe1cfba[_0x3fb303(0xa3)](_0xe1cfba[_0x3fb303(0xab)],_0xe1cfba[_0x3fb303(0x7f)]))return _0x26c6e8[_0x3fb303(0x110)](_0xf259f4);else lipana=_0xe1cfba[_0x3fb303(0x91)](initLipana);}if(!lipana)throw new Error(_0xe1cfba['vvxCX']);let _0x35bde0=_0x4348e9[_0x3fb303(0xe8)]()[_0x3fb303(0x88)](/\s+/g,'')['replace'](/[^0-9]/g,'');if(_0x35bde0[_0x3fb303(0xc4)]('0'))_0x35bde0=_0xe1cfba[_0x3fb303(0x11b)](_0xe1cfba[_0x3fb303(0xa4)],_0x35bde0['substring'](0x1));else!_0x35bde0[_0x3fb303(0xc4)](_0xe1cfba[_0x3fb303(0xa4)])&&(_0xe1cfba[_0x3fb303(0x12d)](_0xe1cfba[_0x3fb303(0xb1)],_0xe1cfba[_0x3fb303(0xb1)])?_0x47f443[_0x3fb303(0x114)](_0x3fb303(0xad)):_0x35bde0=_0xe1cfba[_0x3fb303(0xe2)](_0xe1cfba[_0x3fb303(0xa4)],_0x35bde0));const _0x47fe06=process[_0x3fb303(0xa5)][_0x3fb303(0xba)];!_0x47fe06&&(_0xe1cfba[_0x3fb303(0xe7)](_0xe1cfba[_0x3fb303(0x95)],_0xe1cfba['DTsjt'])?_0x409181[_0x3fb303(0x125)](_0x482d47):console[_0x3fb303(0x114)]('PAYMENT_CALLBACK_URL\x20not\x20set\x20-\x20using\x20default\x20Lipana\x20callback\x20handling'));try{if(_0xe1cfba[_0x3fb303(0xa3)]('bkKAC',_0xe1cfba[_0x3fb303(0x90)])){_0x3bbc6c['error'](_0x3fb303(0x10a));return;}else{const _0x57ba18=await lipana[_0x3fb303(0xed)][_0x3fb303(0x98)]({'phone':_0x35bde0,'amount':_0xe1cfba[_0x3fb303(0xa7)](Number,_0x153cc6),'callbackUrl':_0x47fe06}),_0x3bfbe4=_0x57ba18[_0x3fb303(0x99)]||_0x57ba18[_0x3fb303(0xc0)]||_0x57ba18[_0x3fb303(0x8a)];return pendingPayments[_0x3fb303(0xce)](_0x3bfbe4,{'orderId':_0x568c5b,'phone':_0x35bde0,'amount':_0x153cc6,'status':_0xe1cfba['lAeOD'],'timestamp':Date[_0x3fb303(0xc5)](),'customerJid':_0x14a41a,..._0xe1cfba[_0x3fb303(0xf2)](_0x2c57a5,{'platform':_0x2c57a5[_0x3fb303(0xd9)],'service':_0x2c57a5['service'],'qty':_0x2c57a5[_0x3fb303(0x12b)],'link':_0x2c57a5[_0x3fb303(0x113)]})}),{'success':!![],'reference':_0x3bfbe4,'message':_0xe1cfba[_0x3fb303(0xdf)]};}}catch(_0x47ff8f){return console[_0x3fb303(0x108)](_0xe1cfba[_0x3fb303(0xff)],_0x47ff8f),{'success':![],'error':_0x47ff8f[_0x3fb303(0x102)]||_0xe1cfba[_0x3fb303(0x128)]};}}function getPendingPayment(_0x449104){return pendingPayments['get'](_0x449104);}function a25_0x1bf5(_0x1410ab,_0x5bed2c){_0x1410ab=_0x1410ab-0x7a;const _0x4a3b7c=a25_0x2080();let _0x22442d=_0x4a3b7c[_0x1410ab];return _0x22442d;}async function updatePaymentStatus(_0x35a75e,_0x51d864,_0x35f4d4={}){const _0x5236f4=a25_0x5a029d,_0x259c4f={'YynRO':_0x5236f4(0xf9),'tRlRI':_0x5236f4(0x7d),'VejAL':function(_0xc63047,_0x30ccd3){return _0xc63047===_0x30ccd3;},'rxdeW':_0x5236f4(0x81),'oxOwE':function(_0x3c97f7,_0x51843c,_0xda17cd,_0x421696){return _0x3c97f7(_0x51843c,_0xda17cd,_0x421696);}},_0x1c6ee7=pendingPayments['get'](_0x35a75e);if(_0x1c6ee7){const _0x29c502=_0x259c4f[_0x5236f4(0xe5)][_0x5236f4(0x10e)]('|');let _0x75e1d1=0x0;while(!![]){switch(_0x29c502[_0x75e1d1++]){case'0':(_0x51d864===_0x259c4f['tRlRI']||_0x259c4f[_0x5236f4(0x121)](_0x51d864,_0x259c4f[_0x5236f4(0xbc)]))&&await _0x259c4f['oxOwE'](sendPaymentVerificationToAdmin,_0x1c6ee7,_0x35a75e,_0x35f4d4);continue;case'1':pendingPayments[_0x5236f4(0xce)](_0x35a75e,_0x1c6ee7);continue;case'2':_0x1c6ee7['status']=_0x51d864;continue;case'3':_0x1c6ee7[_0x5236f4(0xc8)]=_0x35f4d4;continue;case'4':_0x1c6ee7[_0x5236f4(0xc1)]=Date[_0x5236f4(0xc5)]();continue;}break;}}}async function sendPaymentVerificationToAdmin(_0x195eb0,_0x4887d3,_0x1f1053){const _0x46d85d=a25_0x5a029d,_0x5896ea={'EqDbb':function(_0x461539,_0x4c57d2){return _0x461539>_0x4c57d2;},'NCROB':_0x46d85d(0xaa),'scuyn':_0x46d85d(0x7c),'RrjNT':'Failed\x20to\x20send\x20receipt\x20via\x20phone\x20number\x20JID','sDWWb':_0x46d85d(0x129),'OEBrP':function(_0x3019ad,_0x20ae3f){return _0x3019ad===_0x20ae3f;},'QmTEM':_0x46d85d(0xcf),'eoGeQ':'Bot\x20socket\x20not\x20available\x20for\x20payment\x20verification\x20notification','GTbUL':_0x46d85d(0x7d),'XjCUC':function(_0x3b7115,_0x3327df){return _0x3b7115===_0x3327df;},'hdZGn':_0x46d85d(0x81),'qivGb':_0x46d85d(0xae),'BKruG':_0x46d85d(0x8d),'knGvz':function(_0x2549cc,_0x15e0cb){return _0x2549cc===_0x15e0cb;},'TEeSt':_0x46d85d(0x12a),'hvGBm':_0x46d85d(0xb5),'kgvkO':function(_0x149b9c,_0x54158a){return _0x149b9c===_0x54158a;},'snSlo':_0x46d85d(0x82),'pBxjH':_0x46d85d(0x100),'aQEMy':_0x46d85d(0x10d),'RjxEF':function(_0x49e072,_0x3fa6c9){return _0x49e072===_0x3fa6c9;},'Zzzku':_0x46d85d(0xd2),'SFrNE':function(_0x2871f9,_0x176137,_0x308e26,_0x2f3e28){return _0x2871f9(_0x176137,_0x308e26,_0x2f3e28);},'Tzryz':function(_0x1fd862,_0x57d835){return _0x1fd862===_0x57d835;},'LAMjc':_0x46d85d(0xa8),'WgzSX':_0x46d85d(0xde)};if(!botSocket){if(_0x5896ea[_0x46d85d(0x9e)](_0x5896ea[_0x46d85d(0xf8)],_0x5896ea[_0x46d85d(0xf8)])){console[_0x46d85d(0x108)](_0x5896ea[_0x46d85d(0x12c)]);return;}else _0x5896ea[_0x46d85d(0xfa)](_0x33d1f5-_0x2d76f1[_0x46d85d(0x96)],_0x14b808)&&_0x19545e[_0x46d85d(0x125)](_0x42a4c2);}const _0x2c47fa=new Date()[_0x46d85d(0x7a)]('en-KE',{'timeZone':_0x46d85d(0x127)}),_0x30ca48=_0x195eb0[_0x46d85d(0xcc)]===_0x5896ea[_0x46d85d(0xa2)]||_0x5896ea[_0x46d85d(0x97)](_0x195eb0['status'],_0x5896ea[_0x46d85d(0xee)])?_0x5896ea[_0x46d85d(0x93)]:_0x5896ea[_0x46d85d(0xfe)],_0x15a837=_0x195eb0[_0x46d85d(0xcc)]===_0x5896ea[_0x46d85d(0xa2)]||_0x5896ea[_0x46d85d(0x122)](_0x195eb0[_0x46d85d(0xcc)],_0x5896ea[_0x46d85d(0xee)])?'âœ…':'âŒ',_0x6eccea=_0x15a837+_0x46d85d(0xfc)+(_0x195eb0['orderId']||_0x46d85d(0xe6))+_0x46d85d(0x9b)+_0x4887d3+_0x46d85d(0xb9)+_0x2c47fa+_0x46d85d(0xb7)+_0x195eb0[_0x46d85d(0x9a)]+_0x46d85d(0xc6)+_0x195eb0['amount']+'/=\x20KES\x0aâ”œâ”€\x20Status:\x20'+_0x30ca48+'\x0aâ”œâ”€\x20Payment\x20Status:\x20'+(_0x195eb0[_0x46d85d(0xcc)]===_0x46d85d(0x7d)||_0x195eb0[_0x46d85d(0xcc)]===_0x5896ea[_0x46d85d(0xee)]?_0x5896ea[_0x46d85d(0x12e)]:_0x5896ea['hvGBm'])+'\x0a\x0a'+(_0x1f1053[_0x46d85d(0x8a)]?'â”œâ”€\x20Transaction\x20ID:\x20'+_0x1f1053[_0x46d85d(0x8a)]+'\x0a':'')+(_0x1f1053[_0x46d85d(0x8f)]?_0x46d85d(0xb2)+_0x1f1053['mpesaRef']+'\x0a':'')+(_0x195eb0[_0x46d85d(0xd9)]?'\x0aðŸ“¦\x20*Service\x20Details:*\x0aâ”œâ”€\x20Platform:\x20'+_0x195eb0[_0x46d85d(0xd9)]+_0x46d85d(0xd0)+_0x195eb0[_0x46d85d(0x12b)]+'\x20'+_0x195eb0[_0x46d85d(0x101)]+_0x46d85d(0xea)+_0x195eb0[_0x46d85d(0x113)]+'\x0a':'')+_0x46d85d(0xe9)+(_0x5896ea[_0x46d85d(0x7e)](_0x195eb0['status'],_0x5896ea['GTbUL'])||_0x5896ea['knGvz'](_0x195eb0[_0x46d85d(0xcc)],_0x5896ea[_0x46d85d(0xee)])?_0x5896ea['snSlo']:_0x5896ea[_0x46d85d(0xa0)])+_0x46d85d(0xa9);try{for(const _0x314e07 of ADMIN_NUMBERS){if(_0x5896ea['OEBrP'](_0x5896ea[_0x46d85d(0xcd)],_0x5896ea[_0x46d85d(0xcd)]))await botSocket['sendMessage'](_0x314e07,{'text':_0x6eccea}),console[_0x46d85d(0x9d)](_0x46d85d(0x120)+_0x314e07);else throw new _0x51e89c(_0x5896ea[_0x46d85d(0x11d)]);}(_0x195eb0[_0x46d85d(0xcc)]===_0x5896ea[_0x46d85d(0xa2)]||_0x195eb0[_0x46d85d(0xcc)]===_0x5896ea['hdZGn'])&&(_0x5896ea[_0x46d85d(0xdc)](_0x46d85d(0xd2),_0x5896ea[_0x46d85d(0x8b)])?await _0x5896ea[_0x46d85d(0xfb)](sendCustomerReceipt,_0x195eb0,_0x4887d3,_0x1f1053):(_0x40b44c[_0x46d85d(0x108)](_0x5896ea[_0x46d85d(0x87)],_0x1f26aa),_0x5c5904['log'](_0x5896ea['RrjNT'])));}catch(_0x37b3ca){if(_0x5896ea[_0x46d85d(0xf5)](_0x5896ea['LAMjc'],_0x5896ea[_0x46d85d(0x9f)]))return _0x5f28ba['toString']()[_0x46d85d(0xf6)](vEuMaa[_0x46d85d(0x10f)])['toString']()[_0x46d85d(0x80)](_0x3e120e)[_0x46d85d(0xf6)](vEuMaa[_0x46d85d(0x10f)]);else console[_0x46d85d(0x108)](_0x46d85d(0xaf),_0x37b3ca);}}async function sendCustomerReceipt(_0x13b64d,_0x1bbbb6,_0x371cf2){const _0x6b7bb9=a25_0x5a029d,_0x272cdf={'TCiRi':_0x6b7bb9(0x11c),'Ezaqd':_0x6b7bb9(0xc3),'ISTtK':'Africa/Nairobi','ABqtQ':'Unable\x20to\x20determine\x20customer\x20JID\x20for\x20receipt','aQYqY':_0x6b7bb9(0xe6),'SjuNs':_0x6b7bb9(0x92),'zVjVD':'VeNNJ','tpqQh':'JLugA','lTkgq':_0x6b7bb9(0x7c)};if(!botSocket){console['error'](_0x272cdf['TCiRi']);return;}const _0x5f9754=new Date()[_0x6b7bb9(0x7a)](_0x272cdf[_0x6b7bb9(0x105)],{'timeZone':_0x272cdf[_0x6b7bb9(0xd4)]});let _0x34f314=_0x13b64d['customerJid'];!_0x34f314&&_0x13b64d[_0x6b7bb9(0x9a)]&&(_0x34f314=_0x13b64d['phone']+_0x6b7bb9(0x11f));if(!_0x34f314){console[_0x6b7bb9(0x108)](_0x272cdf['ABqtQ']);return;}const _0x48fa40='âœ…\x20*PAYMENT\x20CONFIRMED\x20-\x20RECEIPT*\x0aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\x0a\x0aðŸŽ‰\x20*Your\x20payment\x20has\x20been\x20successfully\x20received!*\x0a\x0aðŸ“‹\x20*Receipt\x20Details:*\x0aâ”œâ”€\x20Order\x20ID:\x20'+(_0x13b64d[_0x6b7bb9(0x111)]||_0x272cdf[_0x6b7bb9(0x10c)])+'\x0aâ”œâ”€\x20Transaction\x20Ref:\x20'+_0x1bbbb6+_0x6b7bb9(0x109)+_0x5f9754+_0x6b7bb9(0xe4)+_0x13b64d[_0x6b7bb9(0xbf)]+_0x6b7bb9(0x11a)+_0x13b64d['phone']+'\x0a'+(_0x371cf2[_0x6b7bb9(0x8f)]?'â”œâ”€\x20M-PESA\x20Receipt:\x20'+_0x371cf2[_0x6b7bb9(0x8f)]+'\x0a':'')+(_0x371cf2[_0x6b7bb9(0x8a)]?_0x6b7bb9(0xcb)+_0x371cf2[_0x6b7bb9(0x8a)]+'\x0a':'')+_0x6b7bb9(0x9c);try{_0x272cdf[_0x6b7bb9(0xc9)]!==_0x6b7bb9(0xca)?(await botSocket[_0x6b7bb9(0x84)](_0x34f314,{'text':_0x48fa40}),console[_0x6b7bb9(0x9d)](_0x6b7bb9(0x123)+_0x34f314)):_0x178bd8=_0x5a7602;}catch(_0x576ea6){_0x272cdf[_0x6b7bb9(0x126)]===_0x272cdf[_0x6b7bb9(0xa1)]?_0x89c58f['error'](_0x6b7bb9(0xaf),_0xecc3fa):(console[_0x6b7bb9(0x108)](_0x272cdf['lTkgq'],_0x576ea6),console[_0x6b7bb9(0x9d)](_0x6b7bb9(0xe3)));}}async function verifyPayment(_0x5c42db){const _0x2375fc=a25_0x5a029d,_0x29c7fa={'xdufr':function(_0x134c1c){return _0x134c1c();},'nJBfH':_0x2375fc(0x117),'pmSma':function(_0x111bad,_0x341e5b){return _0x111bad===_0x341e5b;},'ynuip':'SUCCESS','lxodn':_0x2375fc(0xa6),'TqBgw':function(_0x3a92bc,_0x55579b){return _0x3a92bc===_0x55579b;},'KUjiN':function(_0x3e8a54,_0x3a9783,_0x45bcd0,_0x2e0fb6){return _0x3e8a54(_0x3a9783,_0x45bcd0,_0x2e0fb6);},'HNvhE':_0x2375fc(0x86),'AqLwh':'Payment\x20verification\x20error:'};!lipana&&(lipana=_0x29c7fa[_0x2375fc(0xec)](initLipana));if(!lipana)throw new Error(_0x29c7fa[_0x2375fc(0x103)]);try{const _0x4b96f4=await lipana['transactions'][_0x2375fc(0xbd)]({'reference':_0x5c42db}),_0x2451cf={'transactionId':_0x4b96f4[_0x2375fc(0x8a)]||_0x4b96f4['id'],'mpesaRef':_0x4b96f4['mpesaReceiptNumber']||_0x4b96f4['receiptNumber'],'amount':_0x4b96f4['amount'],'status':_0x4b96f4[_0x2375fc(0xcc)],'completedAt':_0x4b96f4[_0x2375fc(0xc1)]||new Date()[_0x2375fc(0xb4)]()},_0xe56916=_0x29c7fa[_0x2375fc(0xe1)](_0x4b96f4['status'],_0x29c7fa['ynuip'])||_0x29c7fa[_0x2375fc(0xe1)](_0x4b96f4['status'],_0x29c7fa[_0x2375fc(0xbb)])||_0x29c7fa[_0x2375fc(0x94)](_0x4b96f4[_0x2375fc(0xcc)],_0x2375fc(0x7d));return await _0x29c7fa[_0x2375fc(0x10b)](updatePaymentStatus,_0x5c42db,_0xe56916?_0x2375fc(0x7d):_0x29c7fa['HNvhE'],_0x2451cf),{'success':_0xe56916,'details':_0x2451cf};}catch(_0x4867c1){return console['error'](_0x29c7fa['AqLwh'],_0x4867c1),{'success':![],'error':_0x4867c1[_0x2375fc(0x102)]};}}function clearExpiredPayments(){const _0x20d555=a25_0x5a029d,_0x24fae9={'QUbBu':function(_0x31c03f,_0x9e2aee){return _0x31c03f*_0x9e2aee;},'VZabo':function(_0x3c2baf,_0x57ead8){return _0x3c2baf-_0x57ead8;}},_0x3beb9f=Date[_0x20d555(0xc5)](),_0xa5cd9f=_0x24fae9[_0x20d555(0x112)](0xa,0x3c)*0x3e8;for(const [_0x1f493b,_0x1df33a]of pendingPayments){_0x24fae9[_0x20d555(0x85)](_0x3beb9f,_0x1df33a['timestamp'])>_0xa5cd9f&&pendingPayments[_0x20d555(0x125)](_0x1f493b);}}setInterval(clearExpiredPayments,0xea60),module[a25_0x5a029d(0xf0)]={'initiateSTKPush':initiateSTKPush,'getPendingPayment':getPendingPayment,'updatePaymentStatus':updatePaymentStatus,'verifyPayment':verifyPayment,'setBotSocket':setBotSocket,'pendingPayments':pendingPayments,'sendCustomerReceipt':sendCustomerReceipt};