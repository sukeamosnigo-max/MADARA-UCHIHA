const a25_0x4c9f22=a25_0x2ac7;(function(_0x43e4ae,_0x138053){const _0x351fa1=a25_0x2ac7,_0x2da782=_0x43e4ae();while(!![]){try{const _0x5cb929=-parseInt(_0x351fa1(0x28d))/0x1+-parseInt(_0x351fa1(0x1e7))/0x2*(parseInt(_0x351fa1(0x201))/0x3)+parseInt(_0x351fa1(0x1fc))/0x4*(-parseInt(_0x351fa1(0x28b))/0x5)+parseInt(_0x351fa1(0x1ee))/0x6*(-parseInt(_0x351fa1(0x277))/0x7)+parseInt(_0x351fa1(0x298))/0x8+parseInt(_0x351fa1(0x23b))/0x9*(-parseInt(_0x351fa1(0x1f5))/0xa)+parseInt(_0x351fa1(0x294))/0xb;if(_0x5cb929===_0x138053)break;else _0x2da782['push'](_0x2da782['shift']());}catch(_0x321cda){_0x2da782['push'](_0x2da782['shift']());}}}(a25_0x23c1,0x762e1));const {Lipana}=require(a25_0x4c9f22(0x226));let lipana=null,botSocket=null;const ADMIN_NUMBERS=[a25_0x4c9f22(0x232),a25_0x4c9f22(0x22b)];function a25_0x2ac7(_0x5266cc,_0x3a7810){_0x5266cc=_0x5266cc-0x1da;const _0xc3f8bb=a25_0x23c1();let _0x437e9e=_0xc3f8bb[_0x5266cc];return _0x437e9e;}function setBotSocket(_0x50ca6f){botSocket=_0x50ca6f;}function initLipana(){const _0x141905=a25_0x4c9f22,_0x5dd15d={'ClqmZ':_0x141905(0x266),'uZUcD':_0x141905(0x262),'jLBRS':function(_0xb2e03f,_0xf26785){return _0xb2e03f===_0xf26785;},'xfAkT':_0x141905(0x1f2),'TrZIK':_0x141905(0x28f),'UfVEM':_0x141905(0x292),'wWdMM':_0x141905(0x1fd),'SVAUp':'(((.+)+)+)+$','UJNBY':_0x141905(0x27e),'LRLmK':function(_0xf3a2bd,_0x1cba0a,_0x45aa9d){return _0xf3a2bd(_0x1cba0a,_0x45aa9d);},'YUmVr':function(_0x57ec92){return _0x57ec92();},'awbQa':function(_0xd6836e,_0xe1323){return _0xd6836e!==_0xe1323;},'fvnsR':_0x141905(0x218),'XoTJP':'LIPANA_SECRET_KEY\x20not\x20set\x20-\x20payment\x20features\x20will\x20not\x20work','FhGtL':function(_0x194abc,_0x1a7619){return _0x194abc===_0x1a7619;},'ONSrC':_0x141905(0x23a),'rVxmg':_0x141905(0x1e3)},_0x4b710e=(function(){const _0x1b5a56=_0x141905,_0x5a32b2={'eVgDQ':_0x5dd15d[_0x1b5a56(0x230)],'mbNme':function(_0x56b653,_0x2750c7){const _0x494112=_0x1b5a56;return _0x5dd15d[_0x494112(0x245)](_0x56b653,_0x2750c7);},'TpNNh':_0x5dd15d['xfAkT'],'nDFNA':_0x5dd15d[_0x1b5a56(0x1e0)],'DDGaA':_0x5dd15d['UfVEM'],'oTAct':_0x5dd15d[_0x1b5a56(0x1ea)]};let _0x1a8205=!![];return function(_0x5929fc,_0x2ed4c8){const _0x402590=_0x1b5a56,_0x32ec4c={'vTDto':function(_0x145206,_0x3e7e45){return _0x145206+_0x3e7e45;},'Rzsvs':_0x5dd15d[_0x402590(0x288)]},_0x1eff35=_0x1a8205?function(){const _0x5c973e=_0x402590,_0x56aa2c={'ewVnS':_0x5a32b2[_0x5c973e(0x240)]};if(_0x5a32b2['mbNme'](_0x5a32b2[_0x5c973e(0x257)],_0x5a32b2[_0x5c973e(0x1e2)]))return _0x58bd48[_0x5c973e(0x28e)](_0x56aa2c[_0x5c973e(0x23c)],_0xdc072b),{'success':![],'error':_0x2c8ddd[_0x5c973e(0x215)]};else{if(_0x2ed4c8){if(_0x5a32b2[_0x5c973e(0x1e6)]===_0x5a32b2['oTAct'])_0x464047=_0x32ec4c[_0x5c973e(0x297)](_0x32ec4c[_0x5c973e(0x263)],_0x9cd3c2);else{const _0x39297d=_0x2ed4c8[_0x5c973e(0x275)](_0x5929fc,arguments);return _0x2ed4c8=null,_0x39297d;}}}}:function(){};return _0x1a8205=![],_0x1eff35;};}()),_0x81b050=_0x5dd15d[_0x141905(0x271)](_0x4b710e,this,function(){const _0x21b833=_0x141905;return _0x81b050['toString']()[_0x21b833(0x204)](_0x5dd15d[_0x21b833(0x1ef)])['toString']()[_0x21b833(0x244)](_0x81b050)[_0x21b833(0x204)](_0x5dd15d[_0x21b833(0x1ef)]);});_0x5dd15d[_0x141905(0x296)](_0x81b050);if(!process[_0x141905(0x236)][_0x141905(0x26e)]){if(_0x5dd15d['awbQa'](_0x5dd15d[_0x141905(0x1f3)],_0x141905(0x218))){_0x2184a9[_0x141905(0x28e)](_0x5dd15d['UJNBY']);return;}else return console[_0x141905(0x20a)](_0x5dd15d[_0x141905(0x221)]),null;}const _0x497241=_0x5dd15d['FhGtL'](process['env'][_0x141905(0x246)],_0x5dd15d['ONSrC'])?_0x5dd15d['ONSrC']:_0x5dd15d[_0x141905(0x26b)];return console[_0x141905(0x247)](_0x141905(0x1db)+_0x497241+'\x20mode'),new Lipana({'apiKey':process[_0x141905(0x236)][_0x141905(0x26e)],'environment':_0x497241});}lipana=initLipana();const pendingPayments=new Map();function a25_0x23c1(){const _0x1b46da=['env','en-KE','SEdSw','XpNIT','sandbox','14337xuunaD','ewVnS','CUbtK','set','OqBmC','eVgDQ','jfhNc','exports','startsWith','constructor','jLBRS','LIPANA_ENV','log','YwucD','substring','cJVRm','\x0aâ”œâ”€\x20Date\x20&\x20Time:\x20','toString','replace','service','â”œâ”€\x20Status:\x20âœ…\x20CONFIRMED\x0a\x0aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\x0a\x0aâš¡\x20*What\x27s\x20Next?*\x0aYour\x20order\x20is\x20being\x20processed\x20and\x20will\x20be\x20delivered\x20within\x20a\x20few\x20minutes.\x0a\x0aðŸ“ž\x20*Need\x20Help?*\x0aContact\x20support:\x20254745282166\x20or\x20254759424232\x0a\x0aThank\x20you\x20for\x20your\x20business!\x20ðŸ™\x0a\x0aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\x0aðŸ¤–\x20MADARA\x20UCHIHA\x20Bot','VnSxb','NxhLA','smgNj','(((.+)+)+)+$','â”œâ”€\x20Transaction\x20ID:\x20','timestamp','EQxXQ','TpNNh','qyxcm','âŒ\x20FAILED','DFdix','N/A','oVCXY','CWPcz','initiateStkPush','uBtrx','Failed\x20to\x20send\x20receipt\x20via\x20phone\x20number\x20JID','now','Payment\x20verification\x20error:','Rzsvs','rWkRv','\x0aâ”œâ”€\x20Time:\x20','254','receiptNumber','FqjOg','khpyN','CgaiW','rVxmg','Africa/Nairobi','mpesaReceiptNumber','LIPANA_SECRET_KEY','IPhZE','/=\x20KES\x0aâ”œâ”€\x20Status:\x20','LRLmK','MeSmf','Payment\x20initiation\x20failed','paymentDetails','apply','yJkAF','7nQNiKw','hxnpm','delete','hcQFj','ygDAD','TRUE\x20âœ“','EsgTL','Bot\x20socket\x20not\x20available\x20for\x20customer\x20receipt','ZvDaR','@s.whatsapp.net','QHGgB','Unable\x20to\x20determine\x20customer\x20JID\x20for\x20receipt','\x0a\x0aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\x0aðŸ¤–\x20MADARA\x20UCHIHA\x20Payment\x20System','âš ï¸\x20*ACTION:\x20Payment\x20failed\x20-\x20contact\x20customer\x20for\x20resolution*','QxPkB','RNTXJ','link','ClqmZ','wDBDd','\x0aâ”œâ”€\x20Link:\x20','55fHAwPS','qty','11828tAkjnt','error','YUjdw','sendMessage','amount','XXkgy','Error\x20sending\x20payment\x20verification\x20to\x20admin:','18587206CjFaYB','â”œâ”€\x20M-PESA\x20Receipt:\x20','YUmVr','vTDto','4036512OOcVrT','DJSDh','HyNBN','transactions','xzCpB','\x0aâ”œâ”€\x20Payment\x20Status:\x20','Initializing\x20Lipana\x20in\x20','vHLHE','Bot\x20socket\x20not\x20available\x20for\x20payment\x20verification\x20notification','wBCui','wwIsQ','TrZIK','iKIaH','nDFNA','production','SUCCESS','Payment\x20system\x20not\x20configured.\x20Contact\x20admin\x20to\x20set\x20up\x20LIPANA_SECRET_KEY','DDGaA','315256jiONuH','ZcIWY','odKUM','wWdMM','QyqtV','completed','\x0aâ”œâ”€\x20Service:\x20','4901502dWvBbY','SVAUp','platform','completedAt','zBQXk','fvnsR','PAYMENT_CALLBACK_URL','3930tkfPvi','âœ…\x20SUCCESS','failed','biIsn','WRURq','\x0aâ”œâ”€\x20Transaction\x20Ref:\x20','BumNf','35572JAkWzH','ojjln','status','toISOString','tKeSx','3QlYcJK','ZcFgE','âœ…\x20Receipt\x20sent\x20to\x20customer:\x20','search','DPbhg','PAYMENT_CALLBACK_URL\x20not\x20set\x20-\x20using\x20default\x20Lipana\x20callback\x20handling','customerJid','hWCGC','YQIpD','warn','dghQL','DnREC','toLocaleString','mEnMc','QpqBy','mpesaRef','Payment\x20system\x20not\x20configured','âœ…\x20Payment\x20verification\x20sent\x20to\x20admin:\x20','orderId','EjsMm','message','bTNup','mYSpV','Xxadp','\x20*PAYMENT\x20VERIFICATION*\x0aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\x0a\x0aðŸ“‹\x20*Transaction\x20Details:*\x0aâ”œâ”€\x20Order\x20ID:\x20','success','â”œâ”€\x20M-PESA\x20Ref:\x20','tigDX','uCCWe','BOnwv','FfHkn','get','XoTJP','sMYHw','transactionId','YkKUg','pending','@lipana/sdk','QxYOQ','uSvGp','phone','\x0aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\x0a\x0a','254759424232@s.whatsapp.net','vUaor','COMPLETED','ljeKb','\x0aðŸ“¦\x20*Service\x20Details:*\x0aâ”œâ”€\x20Platform:\x20','uZUcD','âœ…\x20*PAYMENT\x20CONFIRMED\x20-\x20RECEIPT*\x0aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\x0a\x0aðŸŽ‰\x20*Your\x20payment\x20has\x20been\x20successfully\x20received!*\x0a\x0aðŸ“‹\x20*Receipt\x20Details:*\x0aâ”œâ”€\x20Order\x20ID:\x20','254745282166@s.whatsapp.net','AKogJ','/=\x20KES\x0aâ”œâ”€\x20Phone\x20Number:\x20','foErA'];a25_0x23c1=function(){return _0x1b46da;};return a25_0x23c1();}async function initiateSTKPush(_0x1a0a28,_0x19e735,_0x4ce5ed,_0x16af40=null,_0x7882e4=null){const _0x2661d2=a25_0x4c9f22,_0x1947cb={'IPhZE':'Lipana\x20STK\x20Push\x20Error:','QxPkB':_0x2661d2(0x273),'QxYOQ':_0x2661d2(0x1e5),'vUaor':_0x2661d2(0x253),'gHLfO':_0x2661d2(0x228),'FfHkn':function(_0x5e9109){return _0x5e9109();},'LANRC':function(_0x460ecc,_0xa9b5f2){return _0x460ecc===_0xa9b5f2;},'QyqtV':'gqqcQ','wDBDd':_0x2661d2(0x20b),'smgNj':function(_0x4829c1,_0x2cd898){return _0x4829c1+_0x2cd898;},'DnREC':_0x2661d2(0x266),'AKogJ':function(_0xc446c4,_0x297ef2){return _0xc446c4===_0x297ef2;},'rWkRv':_0x2661d2(0x1e8),'jfhNc':'NxhLA','HyNBN':_0x2661d2(0x206),'EjsMm':function(_0x49e704,_0x457cf5){return _0x49e704===_0x457cf5;},'yJkAF':_0x2661d2(0x24a),'iKIaH':function(_0xebdeef,_0x48b9a6){return _0xebdeef(_0x48b9a6);},'iTLCM':function(_0x3b0c65,_0x25f493){return _0x3b0c65&&_0x25f493;}};if(!lipana){if(_0x1947cb['gHLfO']===_0x2661d2(0x228))lipana=_0x1947cb[_0x2661d2(0x21f)](initLipana);else return _0x170999[_0x2661d2(0x28e)](_0x1947cb[_0x2661d2(0x26f)],_0x5e81c0),{'success':![],'error':_0x11d91a['message']||_0x1947cb[_0x2661d2(0x285)]};}if(!lipana){if(_0x1947cb['LANRC'](_0x1947cb[_0x2661d2(0x1eb)],_0x1947cb[_0x2661d2(0x1eb)]))throw new Error(_0x1947cb[_0x2661d2(0x227)]);else _0x21ceed=_0x42d545();}let _0x198e23=_0x1a0a28['toString']()[_0x2661d2(0x24d)](/\s+/g,'')[_0x2661d2(0x24d)](/[^0-9]/g,'');if(_0x198e23[_0x2661d2(0x243)]('0')){if(_0x1947cb[_0x2661d2(0x289)]!=='dghQL')throw new _0x5973bb(_0x1947cb[_0x2661d2(0x227)]);else _0x198e23=_0x1947cb[_0x2661d2(0x252)](_0x1947cb[_0x2661d2(0x20c)],_0x198e23[_0x2661d2(0x249)](0x1));}else{if(!_0x198e23[_0x2661d2(0x243)](_0x1947cb['DnREC'])){if(_0x1947cb[_0x2661d2(0x233)](_0x1947cb[_0x2661d2(0x264)],_0x1947cb[_0x2661d2(0x264)]))_0x198e23=_0x1947cb[_0x2661d2(0x252)](_0x2661d2(0x266),_0x198e23);else return _0x49db6e[_0x2661d2(0x24c)]()['search'](iZSktn['vUaor'])[_0x2661d2(0x24c)]()[_0x2661d2(0x244)](_0x25e3ea)[_0x2661d2(0x204)](iZSktn[_0x2661d2(0x22c)]);}}const _0x352771=process[_0x2661d2(0x236)][_0x2661d2(0x1f4)];if(!_0x352771){if(_0x2661d2(0x251)===_0x1947cb[_0x2661d2(0x241)])console[_0x2661d2(0x20a)](_0x1947cb[_0x2661d2(0x29a)]);else{if(_0x4bd6f8){const _0x3e000d=_0x50d158[_0x2661d2(0x275)](_0x26d436,arguments);return _0x81ba09=null,_0x3e000d;}}}try{if(_0x1947cb[_0x2661d2(0x214)](_0x1947cb['yJkAF'],_0x1947cb[_0x2661d2(0x276)])){const _0xeddc74=await lipana[_0x2661d2(0x29b)][_0x2661d2(0x25e)]({'phone':_0x198e23,'amount':_0x1947cb[_0x2661d2(0x1e1)](Number,_0x19e735),'callbackUrl':_0x352771}),_0x419110=_0xeddc74['workflowId']||_0xeddc74['checkoutRequestID']||_0xeddc74[_0x2661d2(0x223)];return pendingPayments[_0x2661d2(0x23e)](_0x419110,{'orderId':_0x4ce5ed,'phone':_0x198e23,'amount':_0x19e735,'status':_0x2661d2(0x225),'timestamp':Date[_0x2661d2(0x261)](),'customerJid':_0x16af40,..._0x1947cb['iTLCM'](_0x7882e4,{'platform':_0x7882e4[_0x2661d2(0x1f0)],'service':_0x7882e4[_0x2661d2(0x24e)],'qty':_0x7882e4[_0x2661d2(0x28c)],'link':_0x7882e4[_0x2661d2(0x287)]})}),{'success':!![],'reference':_0x419110,'message':'STK\x20Push\x20sent\x20successfully'};}else return _0x39b70a[_0x2661d2(0x220)](_0x47fb23);}catch(_0x1f4d1f){return console[_0x2661d2(0x28e)](_0x1947cb[_0x2661d2(0x26f)],_0x1f4d1f),{'success':![],'error':_0x1f4d1f['message']||_0x1947cb[_0x2661d2(0x285)]};}}function getPendingPayment(_0x35f623){const _0x3ea96b=a25_0x4c9f22;return pendingPayments[_0x3ea96b(0x220)](_0x35f623);}async function updatePaymentStatus(_0x20012d,_0x3c67d1,_0x169e86={}){const _0x23ad28=a25_0x4c9f22,_0x374b16={'uBtrx':_0x23ad28(0x293),'wBCui':function(_0x26eac3,_0x163e95){return _0x26eac3===_0x163e95;},'oVCXY':_0x23ad28(0x22e),'biIsn':function(_0x51f290,_0x37a54f){return _0x51f290===_0x37a54f;},'aEwey':'success','YkKUg':_0x23ad28(0x1ec),'QHGgB':function(_0x1ad7e8,_0x2d8d04,_0x208c0b,_0x16dee0){return _0x1ad7e8(_0x2d8d04,_0x208c0b,_0x16dee0);}},_0x8efc70=pendingPayments[_0x23ad28(0x220)](_0x20012d);_0x8efc70&&(_0x374b16[_0x23ad28(0x1de)](_0x374b16[_0x23ad28(0x25c)],'ljeKb')?(_0x8efc70[_0x23ad28(0x1fe)]=_0x3c67d1,_0x8efc70[_0x23ad28(0x1f1)]=Date[_0x23ad28(0x261)](),_0x8efc70[_0x23ad28(0x274)]=_0x169e86,pendingPayments[_0x23ad28(0x23e)](_0x20012d,_0x8efc70),(_0x374b16[_0x23ad28(0x1f8)](_0x3c67d1,_0x374b16['aEwey'])||_0x374b16[_0x23ad28(0x1de)](_0x3c67d1,_0x374b16[_0x23ad28(0x224)]))&&await _0x374b16[_0x23ad28(0x281)](sendPaymentVerificationToAdmin,_0x8efc70,_0x20012d,_0x169e86)):_0x1f7094['error'](_0x374b16[_0x23ad28(0x25f)],_0x554102));}async function sendPaymentVerificationToAdmin(_0x8276ad,_0x577649,_0x3a328c){const _0x2e0673=a25_0x4c9f22,_0x26bf26={'RNTXJ':function(_0x34478e,_0x7a3665){return _0x34478e+_0x7a3665;},'rziru':_0x2e0673(0x266),'OamyC':_0x2e0673(0x282),'CUbtK':function(_0xb20511,_0x42c7cc){return _0xb20511===_0x42c7cc;},'odKUM':'ssVUm','sJIRr':_0x2e0673(0x1dd),'YwucD':_0x2e0673(0x237),'XpNIT':_0x2e0673(0x26c),'wwIsQ':'success','EQxXQ':function(_0x10c9fa,_0x26f297){return _0x10c9fa===_0x26f297;},'ygDAD':_0x2e0673(0x1ec),'sMYHw':_0x2e0673(0x1f6),'tigDX':_0x2e0673(0x259),'tKeSx':_0x2e0673(0x25b),'WRURq':function(_0x4ed103,_0x2534dd){return _0x4ed103===_0x2534dd;},'CWPcz':'FALSE\x20âœ—','ujDGu':function(_0x4d51ee,_0x14c68b){return _0x4d51ee===_0x14c68b;},'mEnMc':'âš¡\x20*ACTION:\x20Payment\x20verified\x20-\x20proceed\x20with\x20service\x20delivery*','uCCWe':_0x2e0673(0x284),'DFdix':_0x2e0673(0x272),'vHLHE':_0x2e0673(0x27d)};if(!botSocket){if(_0x26bf26[_0x2e0673(0x23d)](_0x26bf26[_0x2e0673(0x1e9)],_0x2e0673(0x258)))_0x312acc=_0x26bf26[_0x2e0673(0x286)](_0x26bf26['rziru'],_0x51b3c0[_0x2e0673(0x249)](0x1));else{console[_0x2e0673(0x28e)](_0x26bf26['sJIRr']);return;}}const _0x4b59ab=new Date()[_0x2e0673(0x20d)](_0x26bf26[_0x2e0673(0x248)],{'timeZone':_0x26bf26[_0x2e0673(0x239)]}),_0x271fdb=_0x8276ad[_0x2e0673(0x1fe)]===_0x26bf26[_0x2e0673(0x1df)]||_0x26bf26[_0x2e0673(0x256)](_0x8276ad['status'],_0x26bf26['ygDAD'])?_0x26bf26[_0x2e0673(0x222)]:_0x26bf26[_0x2e0673(0x21c)],_0x15ca66=_0x26bf26[_0x2e0673(0x23d)](_0x8276ad['status'],_0x26bf26[_0x2e0673(0x1df)])||_0x8276ad[_0x2e0673(0x1fe)]===_0x26bf26[_0x2e0673(0x27b)]?'âœ…':'âŒ',_0x2fe7cb=_0x15ca66+_0x2e0673(0x219)+(_0x8276ad[_0x2e0673(0x213)]||_0x26bf26[_0x2e0673(0x200)])+'\x0aâ”œâ”€\x20Reference:\x20'+_0x577649+_0x2e0673(0x265)+_0x4b59ab+'\x0a\x0aðŸ’³\x20*Payment\x20Information:*\x0aâ”œâ”€\x20Phone:\x20'+_0x8276ad[_0x2e0673(0x229)]+'\x0aâ”œâ”€\x20Amount:\x20'+_0x8276ad[_0x2e0673(0x291)]+_0x2e0673(0x270)+_0x271fdb+_0x2e0673(0x1da)+(_0x26bf26[_0x2e0673(0x1f9)](_0x8276ad[_0x2e0673(0x1fe)],_0x26bf26[_0x2e0673(0x1df)])||_0x26bf26[_0x2e0673(0x256)](_0x8276ad[_0x2e0673(0x1fe)],_0x26bf26[_0x2e0673(0x27b)])?_0x2e0673(0x27c):_0x26bf26[_0x2e0673(0x25d)])+'\x0a\x0a'+(_0x3a328c[_0x2e0673(0x223)]?_0x2e0673(0x254)+_0x3a328c['transactionId']+'\x0a':'')+(_0x3a328c[_0x2e0673(0x210)]?_0x2e0673(0x21b)+_0x3a328c['mpesaRef']+'\x0a':'')+(_0x8276ad[_0x2e0673(0x1f0)]?_0x2e0673(0x22f)+_0x8276ad[_0x2e0673(0x1f0)]+_0x2e0673(0x1ed)+_0x8276ad['qty']+'\x20'+_0x8276ad[_0x2e0673(0x24e)]+_0x2e0673(0x28a)+_0x8276ad['link']+'\x0a':'')+_0x2e0673(0x22a)+(_0x26bf26['ujDGu'](_0x8276ad[_0x2e0673(0x1fe)],_0x26bf26[_0x2e0673(0x1df)])||_0x26bf26[_0x2e0673(0x1f9)](_0x8276ad[_0x2e0673(0x1fe)],'completed')?_0x26bf26[_0x2e0673(0x20e)]:_0x26bf26[_0x2e0673(0x21d)])+_0x2e0673(0x283);try{for(const _0x81c376 of ADMIN_NUMBERS){if(_0x26bf26[_0x2e0673(0x25a)]===_0x26bf26[_0x2e0673(0x1dc)]){_0xf2a063[_0x2e0673(0x28e)](_0x26bf26['OamyC']);return;}else await botSocket[_0x2e0673(0x290)](_0x81c376,{'text':_0x2fe7cb}),console[_0x2e0673(0x247)](_0x2e0673(0x212)+_0x81c376);}(_0x26bf26[_0x2e0673(0x256)](_0x8276ad[_0x2e0673(0x1fe)],_0x26bf26[_0x2e0673(0x1df)])||_0x26bf26[_0x2e0673(0x23d)](_0x8276ad[_0x2e0673(0x1fe)],_0x26bf26['ygDAD']))&&await sendCustomerReceipt(_0x8276ad,_0x577649,_0x3a328c);}catch(_0x445ce9){console[_0x2e0673(0x28e)](_0x2e0673(0x293),_0x445ce9);}}async function sendCustomerReceipt(_0x36e04,_0x58424d,_0x4ac7d8){const _0xf19612=a25_0x4c9f22,_0x43d3a5={'ZvDaR':'Bot\x20socket\x20not\x20available\x20for\x20customer\x20receipt','FJyuc':_0xf19612(0x26c),'DPbhg':_0xf19612(0x282),'FAuCw':'Error\x20sending\x20receipt\x20to\x20customer:','xzCpB':_0xf19612(0x260)};if(!botSocket){console[_0xf19612(0x28e)](_0x43d3a5[_0xf19612(0x27f)]);return;}const _0xe6fd7c=new Date()[_0xf19612(0x20d)](_0xf19612(0x237),{'timeZone':_0x43d3a5['FJyuc']});let _0xd79ef=_0x36e04[_0xf19612(0x207)];!_0xd79ef&&_0x36e04['phone']&&(_0xd79ef=_0x36e04[_0xf19612(0x229)]+_0xf19612(0x280));if(!_0xd79ef){console[_0xf19612(0x28e)](_0x43d3a5[_0xf19612(0x205)]);return;}const _0x3feb2a=_0xf19612(0x231)+(_0x36e04[_0xf19612(0x213)]||_0xf19612(0x25b))+_0xf19612(0x1fa)+_0x58424d+_0xf19612(0x24b)+_0xe6fd7c+'\x0a\x0aðŸ’³\x20*Payment\x20Summary:*\x0aâ”œâ”€\x20Amount\x20Paid:\x20'+_0x36e04[_0xf19612(0x291)]+_0xf19612(0x234)+_0x36e04['phone']+'\x0a'+(_0x4ac7d8[_0xf19612(0x210)]?_0xf19612(0x295)+_0x4ac7d8[_0xf19612(0x210)]+'\x0a':'')+(_0x4ac7d8['transactionId']?_0xf19612(0x254)+_0x4ac7d8[_0xf19612(0x223)]+'\x0a':'')+_0xf19612(0x24f);try{await botSocket[_0xf19612(0x290)](_0xd79ef,{'text':_0x3feb2a}),console[_0xf19612(0x247)](_0xf19612(0x203)+_0xd79ef);}catch(_0x5b6236){console['error'](_0x43d3a5['FAuCw'],_0x5b6236),console[_0xf19612(0x247)](_0x43d3a5[_0xf19612(0x29c)]);}}async function verifyPayment(_0x46a9bf){const _0x54c62a=a25_0x4c9f22,_0xac7f1={'BOnwv':function(_0x427ba6){return _0x427ba6();},'khpyN':function(_0x3ab73a,_0x350204){return _0x3ab73a===_0x350204;},'YQIpD':'HDWvI','bwzjR':function(_0x5ca639){return _0x5ca639();},'hcQFj':function(_0x5d565d,_0x5c3281){return _0x5d565d===_0x5c3281;},'QpqBy':_0x54c62a(0x23f),'Fkngz':_0x54c62a(0x211),'DJSDh':function(_0x381be8,_0x380b5d){return _0x381be8===_0x380b5d;},'mYSpV':_0x54c62a(0x1e4),'hxnpm':_0x54c62a(0x22d),'FqjOg':function(_0x120eab,_0x46e0ea,_0x27f1b2,_0x55984b){return _0x120eab(_0x46e0ea,_0x27f1b2,_0x55984b);},'foErA':_0x54c62a(0x21a),'BumNf':_0x54c62a(0x1f7),'ZcFgE':_0x54c62a(0x262)};!lipana&&(_0xac7f1[_0x54c62a(0x269)](_0xac7f1['YQIpD'],_0xac7f1[_0x54c62a(0x209)])?lipana=_0xac7f1['bwzjR'](initLipana):_0x3eb155=_0xac7f1[_0x54c62a(0x21e)](_0x4b203b));if(!lipana){if(_0xac7f1[_0x54c62a(0x27a)]('OqBmC',_0xac7f1[_0x54c62a(0x20f)]))throw new Error(_0xac7f1['Fkngz']);else _0x244942[_0x54c62a(0x279)](_0x458cbd);}try{const _0x42ba70=await lipana['transactions']['query']({'reference':_0x46a9bf}),_0x191ea0={'transactionId':_0x42ba70['transactionId']||_0x42ba70['id'],'mpesaRef':_0x42ba70[_0x54c62a(0x26d)]||_0x42ba70[_0x54c62a(0x267)],'amount':_0x42ba70[_0x54c62a(0x291)],'status':_0x42ba70['status'],'completedAt':_0x42ba70['completedAt']||new Date()[_0x54c62a(0x1ff)]()},_0x3dc8c9=_0xac7f1[_0x54c62a(0x299)](_0x42ba70[_0x54c62a(0x1fe)],_0xac7f1[_0x54c62a(0x217)])||_0x42ba70[_0x54c62a(0x1fe)]===_0xac7f1[_0x54c62a(0x278)]||_0xac7f1['khpyN'](_0x42ba70[_0x54c62a(0x1fe)],_0x54c62a(0x21a));return await _0xac7f1[_0x54c62a(0x268)](updatePaymentStatus,_0x46a9bf,_0x3dc8c9?_0xac7f1[_0x54c62a(0x235)]:_0xac7f1[_0x54c62a(0x1fb)],_0x191ea0),{'success':_0x3dc8c9,'details':_0x191ea0};}catch(_0x16fe09){return console[_0x54c62a(0x28e)](_0xac7f1[_0x54c62a(0x202)],_0x16fe09),{'success':![],'error':_0x16fe09[_0x54c62a(0x215)]};}}function clearExpiredPayments(){const _0x2b6b1c=a25_0x4c9f22,_0x1133cc={'spaYZ':function(_0x561faa,_0x3cfc9e){return _0x561faa>_0x3cfc9e;},'CgaiW':function(_0x11d0c5,_0x3a9cec){return _0x11d0c5-_0x3a9cec;},'VnSxb':function(_0x5d7e45,_0x2fbd7c){return _0x5d7e45*_0x2fbd7c;},'hWCGC':function(_0x35bce7,_0x190f92){return _0x35bce7!==_0x190f92;},'SEdSw':_0x2b6b1c(0x216)},_0x4391a5=Date[_0x2b6b1c(0x261)](),_0x31a03c=_0x1133cc[_0x2b6b1c(0x250)](_0x1133cc['VnSxb'](0xa,0x3c),0x3e8);for(const [_0x16f456,_0x3d4c43]of pendingPayments){_0x4391a5-_0x3d4c43[_0x2b6b1c(0x255)]>_0x31a03c&&(_0x1133cc[_0x2b6b1c(0x208)](_0x1133cc['SEdSw'],_0x1133cc[_0x2b6b1c(0x238)])?_0x1133cc['spaYZ'](_0x1133cc[_0x2b6b1c(0x26a)](_0x1509b4,_0x360f08[_0x2b6b1c(0x255)]),_0x310f9c)&&_0x6e8e45[_0x2b6b1c(0x279)](_0x2978b5):pendingPayments[_0x2b6b1c(0x279)](_0x16f456));}}setInterval(clearExpiredPayments,0xea60),module[a25_0x4c9f22(0x242)]={'initiateSTKPush':initiateSTKPush,'getPendingPayment':getPendingPayment,'updatePaymentStatus':updatePaymentStatus,'verifyPayment':verifyPayment,'setBotSocket':setBotSocket,'pendingPayments':pendingPayments,'sendCustomerReceipt':sendCustomerReceipt};